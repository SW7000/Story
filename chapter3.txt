This is chapter 3 modified to be better